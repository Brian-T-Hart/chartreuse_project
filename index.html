<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Project#1</title>
	<meta name="viewport" content="width=device-width, maximum-scale = 1.0, minimum-scale = 1.0, initial-scale=1.0" />
	<!-- bootstrap link -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<!-- stylesheet -->
	<link rel="stylesheet" type="text/css" href="assets/css/style.css">
	<!-- <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false&libraries=places&language=en-AU"></script> -->
	<script src="https://cdn.jsdelivr.net/momentjs/2.12.0/moment.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>

<body>

	<nav class="navbar navbar-default navbar-fixed-top">
		<div class="container container-fluid">
			<div class="navbar-heading text-left">
				<h2>Local Events</h2>
			</div>
		</div>
	</nav>
		 
	<article> <!-- is this necessary? -->
	<div class="row container-fluid">
		<div id="stackContainer">
				<div id="stack">
					<figure>
						<div>
							<form>
								<p>Search City</p></div>
								<ul class="two">
								<li><input type="text" name="location" class="form-control" placeholder="City" id="search-bar"/>
								<li><button class="btn btn-default" type="submit" id="submit-id" value="Show on Map" onclick="displayOnMap()"><i class="glyphicon glyphicon-search"></i></button></li>
								<li><input type="button" id="btnRestaurant" value="Search Restaurant" onclick="searchNearBy('restaurant')"/></li>
								</li>
								</ul>
							</form>
					</figure>
					<figure>
						<div>
							<span class="city wea-de"><p>Local Weather</p></span>
				        	<span class="country wea-de"></span>
				        	<span class="temp wea-de"></span>
						</div>
						<ul class="two">
							<li class="humidity"></li>
							<li class="sunrise"></li>
							<li class="sunset"></li>		
						</ul>
					</figure>
					<figure>
						<div><p>Choose Dates</p></div>
					<ul class="two">
						<li><a id="today" href="#"></a></li>
						<li><a id="tomorrow" href="#"></a></li>
						<li><a id="dayafter" href="#"></a></li>
					</ul>
					</figure>
				</div>
			</div>	
		</div>
	</div>
	</article>

	<div id="displayPanel" class="panel panel-primary">
		<div class="panel-heading tab">
		  <button class="tablinks" id="btnFreeEvents" onclick="getEvents('free')">Free Events</button>
		  <button class="tablinks" id="btnPopularEvents" onclick="getEvents('paid')">Popular Events</button>
		  <!-- <button class="tablinks" id="btnHotels" onclick="myFunction('Hotels')">Hotels</button> -->
		</div>
		<div id="displayInfo" class="tabcontent">
		</div>
	</div>
	<div class="row">
		<div id="map">
		</div>
	</div>
	<script type="text/javascript">
		console.log('ready');
	var geocoder, map, marker, cityLocation; 
      function displayOnMap(){
      	var cityName = $("#search-bar").val();
      	if((cityName !== null) || (cityName !== "")){
      		geocoder = new google.maps.Geocoder();
      		if(geocoder){
      			geocoder.geocode({"address":cityName}, function(results, status){
      				if(status === google.maps.GeocoderStatus.OK){
      					if(status !== google.maps.GeocoderStatus.ZERO_RESULTS){
      						map.setCenter(results[0].geometry.location);
      						cityLocation = results[0].geometry.location;
      						marker = new google.maps.Marker({
      							position: cityLocation,
      							map: map,
      							title: cityName,
      							animation: google.maps.Animation.DROP,
      							icon: 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png'
      						});
      					} else{
      						console.log("No results found");
      					}
      				} else{
      					console.log("Geocode was not successful for the following reason " + status);
      				}
      			});
      		}
      	}
      }

      function initMap() {  
      console.log("initmap working");    	
      	if(navigator.geolocation){
      		navigator.geolocation.getCurrentPosition(function(position){
      			var uluru = {
      				lat: position.coords.latitude,
      				lng: position.coords.longitude
      			};
      			map = new google.maps.Map(document.getElementById('map'),{
      				zoom: 10,
      				center: uluru
      			});
      			marker = new google.maps.Marker({
      				position: uluru,
      				map: map,
      				animation: google.maps.Animation.DROP,
      				icon: 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png'
      			});
      		});
      	}
      }

      function autocomplete(){
      	var autocomplete = new google.maps.places.Autocomplete((document.getElementById('search-bar')),
                     {types:['geocode']});
      }

      function searchNearBy(searchType){
      	var request = {
      		location: cityLocation,
      		radius: '500',
      		types: [searchType]
      	};
      	var searchResults = new google.maps.places.PlacesService(map);
      	searchResults.nearbySearch(request, function(results, status){
      		if(status === google.maps.places.PlacesServiceStatus.OK){
      			results.forEach(function(item, index){
      				marker = new google.maps.Marker({
      					position:item.vicinity,
      					map: map,
      					title: item.vicinity,
      					animation: google.maps.Animation.DROP,
      					icon: 'http://maps.google.com/mapfiles/ms/icons/red-dot.png'
      				});
      			});
      		}else{
      			console.log("No results returned for the type of service requested");
      		}
      	});
      }
	</script>
	<script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDTgS4kfcZbPUE8-L8Adah8y2AlOPkTwHM&callback=initMap&libraries=places">
    </script>

<nav id="footer" class="navbar navbar-default navbar-fixed-bottom">
	<div class="mt-5">
	  	@copyright Chartreuse_Project#1
  		<ul class="social-icon">
			<li><a href="https://www.facebook.com/" target="_blank" ><img src="assets/images/facebook.png" alt="facebook" id="socialiconImg"></a></li>
	
			<li><a href="https://twitter.com/" target="_blank">
				<img src="assets/images/twitter.jpg" alt="twitter" id="socialiconImg"></a></li>
	
			<li><a href="https://github.com" target="_blank">
				<img src="assets/images/github.png" alt="github" id="socialiconImg"></a></li>
	
			<li><a href="https://linkedin.com" target="_blank">
				<img src="assets/images/linkedin.png" alt="linkedin" id="socialiconImg"></a></li>
		</ul>
	</div>
</nav>
    
	
	<script src="https://www.gstatic.com/firebasejs/live/3.0/firebase.js"></script>
	
	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	<!-- <script type="text/javascript" src="js/main.js"></script> -->
	<script type="text/javascript" src="assets/javascript/app.js"></script>
	
	<!-- <script>
	function initMap() {
	    var mapProp= {
		    center:new google.maps.LatLng(51.508742,-0.120850),
		    zoom:5,
		};
		var map=new google.maps.Map(document.getElementById("displayMap"),mapProp);
	}

    </script> -->
	

</body>
</html>